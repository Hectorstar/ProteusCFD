EXE_SOLVER = ucs
EXE_DECOMP = udecomp
EXE_RECOMP = urecomp
EXE_FINDPOINT = findpoint
EXE_PORTOPT = opt.x
EXE_CHEMPROPS = chemprops.x
EXE_ALL = $(EXE_SOLVER) $(EXE_DECOMP) $(EXE_RECOMP) $(EXE_FINDPOINT)\
	$(EXE_PORTOPT) $(EXE_CHEMPROPS)

SRCS_SOLVER = ./ucs/main.cpp ./ucs/eqnset.cpp ./ucs/threaded.cpp ./ucs/parallel.cpp \
	       ./ucs/customics.cpp ./ucs/oddsNends.cpp ./ucs/portFileio.cpp \
	       ./ucs/elements.cpp ./ucs/dataInfo.cpp ./ucs/derivatives.cpp

SRCS_DECOMP = decomp.cpp io.cpp parallel.cpp\
	 oddsNends.cpp dataInfo.cpp
SRCS_RECOMP = recomp.cpp io.cpp parallel.cpp\
	 oddsNends.cpp dataInfo.cpp
SRCS_FINDPOINT = find_point.cpp io.cpp parallel.cpp \
	 oddsNends.cpp dataInfo.cpp
CSRCS_PORTOPT = portDriver.cpp portFunctions.cpp portFileio.cpp lineSearch.cpp
FSRCS_PORTOPT = portF.f
SRCS_CHEMPROPS = chemprops.cpp elements.cpp 
SRCS_ALL = $(SRCS_SOLVER) decomp.cpp recomp.cpp io.cpp find_point.cpp $(CSRCS_PORTOPT)\
	 chemprops.cpp 
OBJS_SOLVER = $(SRCS_SOLVER:.cpp=.o)
OBJS_DECOMP = $(SRCS_DECOMP:.cpp=.o)
OBJS_RECOMP = $(SRCS_RECOMP:.cpp=.o)
OBJS_FINDPOINT = $(SRCS_FINDPOINT:.cpp=.o)
OBJS_PORTOPT = $(CSRCS_PORTOPT:.cpp=.o) $(FSRCS_PORTOPT:.cpp=.o)
OBJS_CHEMPROPS = $(SRCS_CHEMPROPS:.cpp=.o)
OBJS_ALL = $(SRCS_ALL:.cpp=.o)

all: $(EXE_SOLV4ER) $(EXE_DECOMP) $(EXE_RECOMP) $(EXE_FINDPOINT) $(EXE_PORTOPT)\
	$(EXE_CHEMPROPS)

$(EXE_SOLVER): $(OBJS_SOLVER)
	$(MPICXX) $(LINK_OPTS) -o $(EXE_SOLVER) $(LCXXFLAGS) $(OBJS_SOLVER) $(CXXLIBS) -lstructdyn -ltinyxml

$(EXE_DECOMP): $(OBJS_DECOMP)
	$(MPICXX) $(LINK_OPTS) -o $(EXE_DECOMP) $(LCXXFLAGS) -L$(METIS_LIB) $(OBJS_DECOMP) $(CXXLIBS) -lmetis -ltinyxml

$(EXE_RECOMP): $(OBJS_RECOMP)
	$(MPICXX) $(LINK_OPTS) -o $(EXE_RECOMP) $(LCXXFLAGS) $(OBJS_RECOMP) $(CXXLIBS) -ltinyxml

$(EXE_FINDPOINT): $(OBJS_FINDPOINT)
	$(MPICXX) $(LINK_OPTS) -o $(EXE_FINDPOINT) $(LCXXFLAGS) $(OBJS_FINDPOINT) $(CXXLIBS) -ltinyxml

$(EXE_PORTOPT): $(OBJS_PORTOPT)
	$(FXX) $(FXX_LINK_OPTS) -o $(EXE_PORTOPT) $(LCXXFLAGS) $(OBJS_PORTOPT) $(FXXLIBS) -lcommon

$(EXE_CHEMPROPS): $(OBJS_CHEMPROPS)
	$(MPICXX) $(LINK_OPTS) -o $(EXE_CHEMPROPS) $(LCXXFLAGS) $(OBJS_CHEMPROPS) $(CXXLIBS)

cleanucs:
	rm $(OBJS_ALL) $(EXE_ALL) Make.depend

todo: 
	grep -iRn todo $(SRCS_SOLVER) $(SRCS_DECOMP) $(SRCS_RECOMP) \
	$(SRCS_FINPOINT)./*.h ./*.tcc

Make.depend:
	$(MPICXX) -MM $(INCLUDES) $(SRCS_SOLVER) $(SRCS_DECOMP) $(SRCS_RECOMP) \
	$(SRCS_FINDPOINT) $(SRCS_CHEMPROPS) > Make.depend

include Make.depend
